!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=6)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(10);t.defaultOptions=n.defaultOptions,t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)},t.domLoaded=function(){return new Promise(e=>{"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",()=>e)})},t.addEvent=function(e,t,o,n=!1){null!=e&&(e.addEventListener?e.addEventListener(t,o,n):e.attachEvent?e.attachEvent("on"+t,o):e["on"+t]=o)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e="There was an error"){super(e)}}t.LavaJsError=n;class r extends n{constructor(e){super(`[lava.js] "${typeof e}" is not a valid callback.`)}}t.InvalidCallback=r;class a extends n{constructor(e){super(`[lava.js] A renderable with the label "${e}" was not found.`)}}t.RenderableNotFound=a;class s extends n{constructor(e){super(e)}}t.DataError=s;class i extends n{constructor(e){super(`[lava.js] DOM node where id="${e}" was not found.`)}}t.ElementIdNotFound=i,n.prototype=Error.prototype,s.prototype=n.prototype,r.prototype=n.prototype,i.prototype=n.prototype,a.prototype=n.prototype},function(e,t,o){"use strict";var n,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,o){return Function.prototype.apply.call(e,t,o)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var l=10;function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,o,n){var r,a,s,i;if("function"!=typeof o)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof o);if(void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,o.listener?o.listener:o),a=e._events),s=a[t]),void 0===s)s=a[t]=o,++e._eventsCount;else if("function"==typeof s?s=a[t]=n?[o,s]:[s,o]:n?s.unshift(o):s.push(o),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,i=l,console&&console.warn&&console.warn(i)}return e}function d(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,e))}function h(e,t,o){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:o},r=d.bind(n);return r.listener=o,n.wrapFn=r,r}function p(e,t,o){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?o?[r.listener||r]:[r]:o?function(e){for(var t=new Array(e.length),o=0;o<t.length;++o)t[o]=e[o].listener||e[o];return t}(r):g(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var o=t[e];if("function"==typeof o)return 1;if(void 0!==o)return o.length}return 0}function g(e,t){for(var o=new Array(t),n=0;n<t;++n)o[n]=e[n];return o}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t.push(arguments[o]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var i=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw i.context=s,i}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var c=l.length,u=g(l,c);for(o=0;o<c;++o)a(u[o],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var o,n,r,a,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(o=n[e]))return this;if(o===t||o.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,o.listener||t));else if("function"!=typeof o){for(r=-1,a=o.length-1;a>=0;a--)if(o[a]===t||o[a].listener===t){s=o[a].listener,r=a;break}if(r<0)return this;0===r?o.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(o,r),1===o.length&&(n[e]=o[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,o,n;if(void 0===(o=this._events))return this;if(void 0===o.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==o[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete o[e]),this;if(0===arguments.length){var r,a=Object.keys(o);for(n=0;n<a.length;++n)"removeListener"!==(r=a[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=o[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(2)),a=n(o(4)),s=o(9),i=o(1),l=n(o(11));t.default=class extends r.default{constructor(e){super(),this.type=e.type,this.label=e.label,this.dataSrc=e.data,this.elementId=e.elementId;const t=document.getElementById(this.elementId);t&&(this.container=t),this.options=e.options||{},this.formats=e.formats||[]}get class(){return l.default[this.type].class}get packages(){return[l.default[this.type].package]}get uuid(){return this.type+"::"+this.label}draw(){if("function"==typeof this._preDraw&&(console.log(`[lava.js] Running ${this.uuid}._preDraw()`),this._preDraw()),"function"==typeof this.preDraw&&(console.log(`[lava.js] Running ${this.uuid}.preDraw()`),this.preDraw()),!this.data)throw new i.DataError(`${this.uuid} Could not draw, data is ${this.data}`);this.gchart.draw(this.data,this.options),"function"==typeof this._postDraw&&(console.log(`[lava.js] Running ${this.uuid}._postDraw()`),this._postDraw()),"function"==typeof this.postDraw&&(console.log(`[lava.js] Running ${this.uuid}.postDraw()`),this.postDraw())}async run(){if(!this.container)throw new i.ElementIdNotFound(this.elementId);await this.setData(this.dataSrc),this.formats&&this.applyFormats(),this.draw()}async setData(e){if(e instanceof a.default){console.log(`[lava.js] Sending DataQuery for ${this.uuid}`);const t=await e.send();console.log("[lava.js] Response received:",t),this.data=t.getDataTable()}else this.data=s.createDataTable(e);if(this.data instanceof google.visualization.DataTable==!1)throw new i.DataError(`There was a error setting the data for ${this.uuid}`);console.log(`[lava.js] Data set for ${this.uuid}`,this.data),e.formats&&this.applyFormats(e.formats)}applyFormats(e){e&&(this.formats=e);for(const e of this.formats){const t=new window.google.visualization[e.type](e.options);console.log(`[lava.js] Formatting data for ${this.uuid}.`),console.log(`[lava.js] Formatting column [${e.index}] with:`,e),t.format(this.data,e.index)}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);class r{constructor(e,t,o){this.url=e,this.tap=e=>e,this.opts={sendMethod:"auto"},o&&(this.tap=o),t&&this.opts}static create(e){if(!e.url)throw new n.DataError('"url" is a mandatory parameter for creating a DataQuery.');const t=new r(e.url);return"object"==typeof e.opts&&(t.opts=e.opts),"function"==typeof e.tap&&(t.tap=e.tap),t}async send(){const e=new window.google.visualization.Query(this.url,this.opts);return new Promise((t,o)=>{this.tap(e).send(e=>{e.isError()&&o(e),t(e)})})}}t.default=r},function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(7));t.default=r.default},function(e,t,o){"use strict";o.r(t);var n=o(5),r=o.n(n),a=o(0);window.lava=new r.a,void 0!==window.lavacharts&&window.lava.configure(window.lavacharts.options),window.lava.autorun&&Object(a.domLoaded)().then(()=>{window.lava.run()})},function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(2)),a=n(o(8)),s=n(o(12)),i=n(o(4)),l=o(1),c=n(o(13)),u=o(0);class d extends r.default{constructor(e){super(),this.options=u.defaultOptions,this.volcano=new Map,e&&this.configure(e),this.loader=new c.default(this.options)}get autorun(){return void 0===this.options.autoRun||this.options.autoRun}configure(e){this.options=Object.assign(this.options,e)}async init(){return!1===this.loader.isLoaded&&await this.loader.loadGoogle(),console.log("[lava.js] Google is ready",window.google),window.google}async run(){const e=[];console.log(`[lava.js] v${d.VERSION} Running...`),console.log("[lava.js] Loading options:",this.options),this.attachRedrawHandler();try{await this.init()}catch(e){this.emit("error",e)}this.volcano.forEach(t=>{console.log(`[lava.js] Rendering ${t.uuid}`),e.push(t.run())});try{await Promise.all(e)}catch(e){this.emit("error",e)}console.log("[lava.js] Ready!"),this.emit("ready"),"function"==typeof this.readyCallback&&this.readyCallback()}query(e){return"string"==typeof e?new i.default(e):i.default.create(e)}create(e){return console.log(`[lava.js] Creating a new ${e.type}:`,e),"Dashboard"===e.type?new s.default(e):new a.default(e)}store(e){const t=this.create(e);return console.log(`[lava.js] Storing ${t.uuid}`),this.loader.addPackages(t.packages),this.volcano.set(t.label,t),t}get(e){if(!1===this.volcano.has(e))throw new l.RenderableNotFound(e);return this.volcano.get(e)}ready(e){if("function"!=typeof e)throw new l.InvalidCallback(e);this.readyCallback=e.bind(this)}async loadData(e,t,o){const n=this.get(e);await n.setData(t),n.draw(),"function"==typeof o&&o(n.data,n.gchart)}loadOptions(e,t,o){const n=this.get(e);n.options=Object.assign(n.options,t);try{n.draw()}catch(e){this.emit("error",e)}"function"==typeof o&&o(n.data,n.gchart)}redrawAll(){return 0===this.volcano.size?(console.log("[lava.js] Nothing to redraw."),!1):(console.log(`[lava.js] Redrawing ${this.volcano.size} renderables.`),this.volcano.forEach(e=>{console.log(`[lava.js] Redrawing ${e.uuid}`),e.draw()}),!0)}attachRedrawHandler(){if(!0===this.options.responsive){let e;u.addEvent(window,"resize",()=>{clearTimeout(e),e=setTimeout(()=>{console.log("[lava.js] Window re-sized, redrawing..."),this.redrawAll()},this.options.debounceTimeout)})}}}t.default=d,d.VERSION="4.0.0-beta3"},function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(3));t.default=class extends r.default{constructor(e){super(e),this.png=Boolean(e.png)}_preDraw(){const e=(t=this.container,e=>new window.google.visualization[e](t));var t;this.gchart=e(this.class)}_postDraw(){this.png&&this.drawPng()}drawPng(){const e=document.createElement("img");e.src=this.gchart.getImageURI(),this.container&&(this.container.innerHTML="",this.container.appendChild(e))}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0);t.createDataTable=function(e){return"Function"===n.getType(e)?e(new window.google.visualization.DataTable):"Array"===n.getType(e)?window.google.visualization.arrayToDataTable(e):"Function"===n.getType(e.getTableProperties)?e:"Array"===n.getType(e.data)?window.google.visualization.data.join(new window.google.visualization.DataTable(e.data[0]),new window.google.visualization.DataTable(e.data[1]),e.keys,e.joinMethod,e.dt1Columns,e.dt2Columns):("Object"===n.getType(e.data)&&(e=e.data),new window.google.visualization.DataTable(e))}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultOptions={autoRun:!0,datetimeFormat:"",debounceTimeout:250,locale:"en",mapsApiKey:"",responsive:!0,timezone:"America/Los_Angeles"}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={AnnotationChart:{class:"AnnotationChart",package:"annotationchart",version:1},AreaChart:{class:"AreaChart",package:"corechart",version:1},BarChart:{class:"BarChart",package:"corechart",version:1},BubbleChart:{class:"BubbleChart",package:"corechart",version:1},CalendarChart:{class:"Calendar",package:"calendar",version:1.1},CandlestickChart:{class:"CandlestickChart",package:"corechart",version:1},ColumnChart:{class:"ColumnChart",package:"corechart",version:1},ComboChart:{class:"ComboChart",package:"corechart",version:1},DonutChart:{class:"PieChart",package:"corechart",version:1},GanttChart:{class:"Gantt",package:"gantt",version:1},GaugeChart:{class:"Gauge",package:"gauge",version:1},GeoChart:{class:"GeoChart",package:"geochart",version:1},HistogramChart:{class:"Histogram",package:"corechart",version:1},LineChart:{class:"LineChart",package:"corechart",version:1},PieChart:{class:"PieChart",package:"corechart",version:1},SankeyChart:{class:"Sankey",package:"sankey",version:1},ScatterChart:{class:"ScatterChart",package:"corechart",version:1},SteppedAreaChart:{class:"SteppedAreaChart",package:"corechart",version:1},TableChart:{class:"Table",package:"table",version:1},TimelineChart:{class:"Timeline",package:"timeline",version:1},TreeMapChart:{class:"TreeMap",package:"treemap",version:1},WordTreeChart:{class:"WordTree",package:"wordtree",version:1}}},function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(3));t.default=class extends r.default{constructor(e){e.type="Dashboard",super(e),this.bindings=e.bindings}setup(){this.gchart=new window.google.visualization.Dashboard(this.container)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.options=e,this.API_VERSION="current",this.LOADER_URL="https://www.gstatic.com/charts/loader.js",this.packages=new Set(["corechart"])}get isLoaded(){return void 0!==window.google}get googleLoaderInPage(){const e=document.getElementsByTagName("script");for(const t of Array.from(e))if(t.src===this.LOADER_URL)return!0;return!1}get config(){const e={language:this.options.locale,packages:Array.from(this.packages)};return""!==this.options.mapsApiKey&&(e.mapsApiKey=this.options.mapsApiKey),e}addPackage(e){this.packages.add(e)}addPackages(e){e.forEach(e=>this.packages.add(e))}async loadGoogle(){return console.log("[lava.js] Resolving Google..."),!1===this.googleLoaderInPage&&(console.log("[lava.js] Static loader not found, appending to head"),await this.addGoogleScriptToHead()),console.log("[lava.js] Static loader found, initializing window.google"),this.googleChartLoader()}googleChartLoader(){return new Promise(e=>{console.log("[lava.js] Loading Google with config:",this.config),window.google.charts.load(this.API_VERSION,this.config),window.google.charts.setOnLoadCallback(e)})}async addGoogleScriptToHead(){return new Promise(e=>{const t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=this.LOADER_URL,t.onload=t.onreadystatechange=o=>{("load"===(o=o||window.event).type||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,e())},document.head.appendChild(t)})}}}]);
//# sourceMappingURL=lava.js.map